<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ä»Šå¤©åƒä»€éº¼ï¼Ÿè¼ªç›¤æ±ºå®šï¼</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css" />
    <style>
      .wheel-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        position: relative;
        margin: 2rem auto;
        max-width: 100%;
      }

      #wheel {
        width: clamp(500px, 40vw, 300px);
        height: clamp(500px, 40vw, 300px);
        border: 8px solid #ccc;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        text-align: center;

        transition: transform 4s cubic-bezier(0.25, 0.1, 0.25, 1);
        background: none;
      }

      #pointer {
        position: absolute;
        top: -2.3rem;
        left: 50%;
        transform: translateX(-50%);
        font-size: 2rem;
        color: red;
      }

      #legend {
        position: absolute;
        right: 0rem;
        bottom: -3rem;
        background: rgba(255, 255, 255, 0.9);
        padding: 0.1rem 0.5rem;
        border-radius: 1.75rem;
        box-shadow: 0 0 10px rgba(0,0,0,0.15);
        font-size: 0.95rem;
        max-width: 250px;
        }

      #legend span {
        display: inline-block;
        width: 1rem;
        height: 1rem;
        margin-right: 0.5rem;
        border-radius: 3px;
        }
      #legend h4 {
        margin-bottom: 0.8rem; 
        }


      @media (max-width: 480px) {
        #wheel {
          font-size: 1rem;
        }

        #legend h4 {
          font-size: 1rem;
        }
      }
    </style>
  </head>
  <body>
    <nav class="container-fluid">
      <ul><li><strong>åƒä»€éº¼è¼ªç›¤</strong></li></ul>
    </nav>

    <main class="container">
      <div class="grid">
        <section>
          <hgroup>
            <h1>ä»Šå¤©è¦åƒä»€éº¼å‹’ï¼Ÿ</h1>
            <h3>é»ä¸€ä¸‹å¹«ä½ æ±ºå®šï¼</h3>
          </hgroup>

          <!-- åŒ…ä½è½‰ç›¤ + æŒ‡é‡ -->
          <div class="wheel-container">
            <div id="pointer">â–¼</div>
            <div id="wheel">é»æˆ‘è½‰</div>
            <div id="legend"></div>
          </div>

          <h3 id="result">ğŸ‘‰ ç­‰å¾…è½‰ç›¤çµæœ...</h3>
          <p><a id="mapLink" href="#" target="_blank">ğŸ” åœ¨ Google åœ°åœ–æœå°‹</a></p>

          <h3>è‡ªè¨‚ä½ çš„é¤é»é¸é …ï¼š</h3>
          <form id="customForm">
            <textarea id="customChoices" rows="4" placeholder="è¼¸å…¥é¸é …ï¼Œä»¥é€—è™Ÿåˆ†éš”ï¼Œå¦‚ï¼šæ‹‰éºµ,å£½å¸,ç‚¸é›" required></textarea>
            <button type="submit">æ›´æ–°é¸é …</button>
          </form>

        </section>
      </div>
    </main>

    <script>
      let choices = ['æ‹‰éºµ', 'ç¾©å¤§åˆ©éºµ', 'ä¾¿ç•¶', 'ç‰›æ’', 'ç«é‹', 'æ°´é¤ƒ', 'æ»·å‘³'];
      const colorPalette = [
        '#f78ca0', '#fbc7d4', '#fceabb', '#e0c3fc', '#a1c4fd',
        '#c2e9fb', '#d4fc79', '#ffb347', '#ff6961', '#87e0fd',
        '#b0f2b4', '#d5aae5', '#f9f871', '#ffd3b6', '#d0e1f9'
      ];

      const wheel = document.getElementById('wheel');
      const result = document.getElementById('result');
      const mapLink = document.getElementById('mapLink');
      const form = document.getElementById('customForm');

      let spinning = false;
      
      const renderWheel = () => {
        const anglePer = 360 / choices.length;
        const gradient = choices.map((_, i) => {
          const color = colorPalette[i % colorPalette.length];
          const start = i * anglePer;
          const end = start + anglePer;
          return `${color} ${start}deg ${end}deg`;
        }).join(', ');
        wheel.style.background = `conic-gradient(${gradient})`;
      };

      const renderLegend = () => {
        const legend = document.getElementById('legend');
        legend.innerHTML = '<h4>ğŸ¨ é¡è‰²å°æ‡‰è¡¨ï¼š</h4><ul style="list-style: none; padding: 0;">' +
          choices.map((label, i) => {
            const color = colorPalette[i % colorPalette.length];
            return `<li style="display: flex; align-items: center; margin-bottom: 0.3rem;">
                      <span style="background:${color};"></span> ${label}
                    </li>`;
          }).join('') +
          '</ul>';
      };

      wheel.addEventListener('click', () => {
        if (spinning) return;
        spinning = true;

        const anglePerChoice = 360 / choices.length;
        const randomIndex = Math.floor(Math.random() * choices.length);
        const currentRotation = wheel.style.transform ?
          parseFloat(wheel.style.transform.replace(/[^\d.]/g, '')) || 0 : 0;
        const extraSpins = 360 * 5;
        const targetAngle = anglePerChoice * randomIndex + anglePerChoice / 2;
        const totalAngle = currentRotation + extraSpins + targetAngle;

        wheel.style.transform = `rotate(${totalAngle}deg)`;

        setTimeout(() => {
          const selected = choices[randomIndex];
          result.textContent = `ğŸ‰ ä»Šå¤©åƒï¼š${selected}`;
          mapLink.href = `https://www.google.com/maps/search/${encodeURIComponent(selected)}`;
          mapLink.textContent = `ğŸ” æœå°‹é™„è¿‘çš„ ${selected}`;
          spinning = false;
        }, 4000);
      });

      form.addEventListener('submit', (e) => {
        e.preventDefault();
        const input = document.getElementById('customChoices').value;
        const newChoices = input.split(',').map(item => item.trim()).filter(item => item);
        if (newChoices.length > 0) {
          choices = newChoices;
          renderWheel();
          renderLegend();
          alert('å·²æ›´æ–°é¸é …ï¼');
        } else {
          alert('è«‹è¼¸å…¥è‡³å°‘ä¸€å€‹é¸é …');
        }
      });

      renderWheel();
      renderLegend();
    </script>
  </body>
</html>
